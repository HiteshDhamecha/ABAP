-----------------------------------------------------------------
-- SQL Code Generation
-- Entity: Abstract Stagings
-- Item: spUpdateAbstractStaging
--
-- This was generated by the MemberJunction CodeGen tool.
-- This file should NOT be edited by hand.
-----------------------------------------------------------------

------------------------------------------------------------
----- UPDATE PROCEDURE FOR AbstractStaging
------------------------------------------------------------
DROP PROCEDURE IF EXISTS [dbo].[spUpdateAbstractStaging]
GO

CREATE PROCEDURE [dbo].[spUpdateAbstractStaging]
    @ID uniqueidentifier,
    @SessionID uniqueidentifier,
    @UserID uniqueidentifier,
    @YearOfExp int,
    @AbstractText nvarchar(MAX),
    @UploadUrl nvarchar(500),
    @Session nvarchar(255),
    @User nvarchar(255),
    @FirstName nvarchar(255),
    @LastName nvarchar(255),
    @EventID uniqueidentifier,
    @EventName nvarchar(255),
    @EventStartDate datetime,
    @EventEndDate datetime,
    @Description nvarchar(MAX),
    @EventCreatedAt datetime,
    @EventUpdatedAt datetime
AS
BEGIN
    SET NOCOUNT ON;
    UPDATE
        [dbo].[AbstractStaging]
    SET
        [SessionID] = @SessionID,
        [UserID] = @UserID,
        [YearOfExp] = @YearOfExp,
        [AbstractText] = @AbstractText,
        [UploadUrl] = @UploadUrl,
        [Session] = @Session,
        [User] = @User,
        [FirstName] = @FirstName,
        [LastName] = @LastName,
        [EventID] = @EventID,
        [EventName] = @EventName,
        [EventStartDate] = @EventStartDate,
        [EventEndDate] = @EventEndDate,
        [Description] = @Description,
        [EventCreatedAt] = @EventCreatedAt,
        [EventUpdatedAt] = @EventUpdatedAt
    WHERE
        [ID] = @ID

    -- return the updated record so the caller can see the updated values and any calculated fields
    SELECT
                                        *
                                    FROM
                                        [dbo].[vwAbstractStagings]
                                    WHERE
                                        [ID] = @ID
                                    
END
GO

GRANT EXECUTE ON [dbo].[spUpdateAbstractStaging] TO [cdp_Developer], [cdp_Integration]
GO

------------------------------------------------------------
----- TRIGGER FOR __mj_UpdatedAt field for the AbstractStaging table
------------------------------------------------------------
DROP TRIGGER IF EXISTS [dbo].trgUpdateAbstractStaging
GO
CREATE TRIGGER [dbo].trgUpdateAbstractStaging
ON [dbo].[AbstractStaging]
AFTER UPDATE
AS
BEGIN
    SET NOCOUNT ON;
    UPDATE
        [dbo].[AbstractStaging]
    SET
        __mj_UpdatedAt = GETUTCDATE()
    FROM
        [dbo].[AbstractStaging] AS _organicTable
    INNER JOIN
        INSERTED AS I ON
        _organicTable.[ID] = I.[ID];
END;
GO
        